var Favorites;(function(){function ei(){lt=_ge("hpfp_vs");n=_ge("hpfpbtn_vs");v=_ge("hpff_vs");at=_ge("hp_fav_login_vs");o=o||lt&&n}function hi(n){[g,kt,ut,_ge("notif_favorite_vs"),_ge("hp_fav_all_vs"),_ge("hp_fav_login_vs"),_ge("notif_favorite_p"),_ge("hp_fav_all_p"),ct].forEach(function(n){if(n){var t=n.getAttribute(ti);t?n.setAttribute(rt,t):n.getAttribute(rt)==="-1"&&n.removeAttribute(rt);n.removeAttribute(ni)}});n==i.Promoted&&nt?ci():n==i.VerticalScroll&&v?li():c(g,gt)}function et(){u(g,gt);[g,kt,ut].forEach(function(n){if(n){var t=n.getAttribute(rt);t&&Number(t)!=-1&&n.setAttribute(ti,t);n.setAttribute(rt,"-1");n.setAttribute(ni,"true")}});ot()}function ci(){sj_evt.fire(pt);hp_show(nt)}function li(){sj_evt.fire(pt);hp_show(v)}function ot(){nt&&hp_hide(nt);v&&hp_hide(v)}function k(n,t,r){var u="";t==i.Promoted?u="P":t==i.VerticalScroll&&(u="V");Log.Log("DHTMLClick","HP","ImageFavorites"+n+u+(r?"Error":""))}function wt(n){if(k("Login",n),b){var t=_w.location.href.replace(/^http:/,"https:"),i="https://"+_w.location.host+"/fd/auth/signin?action=interactive&provider=windows_live_id&device=mobile&return_url="+encodeURIComponent(t);_w.location.replace(i)}else _w.Identity&&Identity.popupAuthenticate("WindowsLiveId")}function ii(){ht[y]?(l(ht[y]),u(e,it)):f&&_w.MmFaves&&MmFaves.getStatus([f],function(n){n&&n.IsSuccess&&n.Result.length>0?(l(n.Result[0].Present?r.Favorited:r.NotFavorited),u(e,it)):(k("Status",i.MuseumCard,!0),_H.test||c(e,it),o&&l(r.Unknown))})}function l(i){p=i;ht[y]=i;p==r.Favorited?(c(e,h),a.setAttribute(s,yt)):(u(e,h),a.setAttribute(s,vt));o&&(p==r.Favorited?(t&&(c(t,h),u(t,w),t.setAttribute(s,yt),t.tabIndex=0),n&&(c(n,h),u(n,w),n.setAttribute(s,yt),n.tabIndex=0)):p==r.NotFavorited?(t&&(u(t,h),u(t,w),t.setAttribute(s,vt),t.tabIndex=0),n&&(u(n,h),u(n,w),n.setAttribute(s,vt),n.tabIndex=0)):(t&&(u(t,h),c(t,w),t.setAttribute(s,""),t.tabIndex=-1),n&&(u(n,h),c(n,w),n.setAttribute(s,""),n.tabIndex=-1)))}function ai(n){n===void 0&&(n=i.MuseumCard);f&&(_w.MmFaves&&MmFaves.addImageToHPCollection(f,function(t){t&&t.IsSuccess?k("Add",n):(k("Add",n,!0),l(r.NotFavorited),et())}),l(r.Favorited),hi(n))}function vi(n){n===void 0&&(n=i.MuseumCard);f&&(_w.MmFaves&&MmFaves.removeImageFromFavorites(f,function(t){t&&t.IsSuccess?k("Remove",n):(k("Remove",n,!0),l(r.Favorited))}),l(r.NotFavorited),et())}function yi(n){if(n&&n.length>=2&&n[2]==="nav"){et();var t=n[1];f=t.fav;y=t.startdate;f&&y?ii():_H.test||c(e,it)}}function st(n){_H.mcpf&&n==i.Promoted&&sj_evt.fire(si);p==r.Favorited?vi(n):p==r.NotFavorited&&ai(n)}function bt(r){if(r.keyCode==13){sj_pd(r);sj_sp(r);var u=i.MuseumCard;sj_et(r)==t?u=i.Promoted:sj_et(r)==n&&(u=i.VerticalScroll);st(u)}}function ri(n,t){for(var i=String(n);i.length<t;)i="0"+i;return i}function pi(){var n=new Date,t=n.getFullYear(),i=n.getMonth()+1,r=n.getDate();return t+ri(i,2)+ri(r,2)}function d(){_H.fav&&(f=_H.fav,y=pi(),ii());b||o||(sj_ue(ft,"mouseover",d),sj_ue(ft,"focus",d))}function ui(n,t){if(sj_we(n,t)){while(n!=t&&n.tagName!="A")n=n.parentNode;if(n==t)return!0}return!1}function wi(){_H.vertChunks?sj_evt.bind("vsFavoritesLoaded",fi,1):fi()}function fi(){if(ei(),e&&a&&g){if(sj_be(a,tt,sj_wf(st,i.MuseumCard),!1),sj_be(a,oi,bt),ut&&sj_be(ut,tt,sj_wf(wt,i.MuseumCard)),o){if(t&&(t.onclick=sj_wf(st,i.Promoted),t.onkeydown=bt,ct&&sj_be(ct,tt,sj_wf(wt,i.Promoted))),n){n.onclick=sj_wf(st,i.VerticalScroll);n.onkeydown=bt;at&&sj_be(at,tt,sj_wf(wt,i.VerticalScroll));var f=new AccessiblePopup(v,"#hpff_vs a, #hpff_vs span[tabindex], #hpff_vs .acc_pop_close",ot,n,_qs("#hpff_vs .acc_pop_close"))}sj_evt.bind(pt,ot);sj_be(sj_b,tt,function(i){var r=sj_et(i),u=!0;sj_we(r,t)||sj_we(r,n)?u=!1:(ui(r,nt)||ui(r,v))&&(u=!1);u&&ot()})}sj_evt.bind("updateHpImg",yi);sj_evt.bind("onCardHide",et);b?d():o?d():(sj_be(ft,"mouseover",d),sj_be(ft,"focus",d));u(e,it);o&&(l(r.Unknown),hp_show(dt),hp_showib(lt))}}var r,i;(function(n){n[n.Favorited=0]="Favorited";n[n.NotFavorited=1]="NotFavorited";n[n.Unknown=2]="Unknown"})(r||(r={})),function(n){n[n.MuseumCard=0]="MuseumCard";n[n.Promoted=1]="Promoted";n[n.VerticalScroll=2]="VerticalScroll"}(i||(i={}));var y,f,p,ht={},bi=_w._H&&_H.auth,e=_ge("hp_fav"),a=_ge("hp_fav_img"),kt=_ge("hp_fav_all"),ut=_ge("hp_fav_login"),g=_ge("notif_favorite"),ft=_ge("sh_rdiv"),dt=_ge("hpfp"),t=_ge("hpfpbtn"),nt=_ge("hpff"),ct=_ge("hp_fav_login_p"),o=dt&&t,lt,n,v,at;var vt=a.getAttribute("data-title-add"),yt=a.getAttribute("data-title-rm"),tt="click",oi="keydown",gt="show",s="title",h="active",w="disabled",it="hide",si="onCardShow",pt="onHideAllFlyout",rt="tabindex",ni="aria-hidden",ti="data-oldtabindex",b=_w._H&&_H.cards,c=b?Lib.CssClass.add:hp_addclass,u=b?Lib.CssClass.remove:hp_removeclass,ki=b?Lib.CssClass.contains:hp_hasclass;sj_evt.bind("onRBComplete",wi,1)})(Favorites||(Favorites={}))